"use strict";(self.webpackChunkwebbook=self.webpackChunkwebbook||[]).push([["169"],{3713:function(e,i,n){n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>o,frontMatter:()=>l,metadata:()=>s,toc:()=>m});var s=n(8894),t=n(7259),r=n(5511);let l={title:"\u5E40(Frame) \u8207 \u6642\u9593\u6233(Timestamp)",description:"\u5E40\u7684\u57FA\u672C\u7D50\u69CB\u8207\u5B83\u5728\u50B3\u8F38\u6D41\u7A0B\u4E2D\u7684\u5B9A\u4F4D\u3002",authros:"yhchen",tags:["streaming"],date:new Date("2025-12-08T00:00:00.000Z")},a,d={authorsImageUrls:[]},m=[{value:"\u8996\u8A0A\u5E40(Video Frame)",id:"\u8996\u8A0A\u5E40video-frame",level:2},{value:"\u97F3\u8A0A\u5E40(Audio Frame)",id:"\u97F3\u8A0A\u5E40audio-frame",level:2},{value:"\u6642\u9593\u6233(Timestamp) \u8207 \u6642\u57FA(Timebase)",id:"\u6642\u9593\u6233timestamp-\u8207-\u6642\u57FAtimebase",level:2},{value:"PTS \u8207 DTS",id:"pts-\u8207-dts",level:2},{value:"Frame \u8207 Container \u7684\u95DC\u4FC2",id:"frame-\u8207-container-\u7684\u95DC\u4FC2",level:2},{value:"\u53EF\u80FD\u767C\u751F\u7684\u932F\u8AA4",id:"\u53EF\u80FD\u767C\u751F\u7684\u932F\u8AA4",level:2},{value:"Audio/Video \u4E0D\u540C\u6B65",id:"audiovideo-\u4E0D\u540C\u6B65",level:3},{value:"B-frame \u8A2D\u5B9A\u932F\u8AA4",id:"b-frame-\u8A2D\u5B9A\u932F\u8AA4",level:3}];function c(e){let i={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{children:"\u97F3\u8A0A\u8207\u8996\u8A0A\u7684\u8CC7\u6599\u578B\u614B\u96D6\u7136\u4E0D\u540C\uFF0C\u4F46\u5728\u6240\u6709\u73FE\u4EE3\u4E32\u6D41\u6280\u8853\u4E2D\uFF0C\u5B83\u5011\u9075\u5FAA\u540C\u4E00\u5957\u908F\u8F2F\uFF1A\u8CC7\u6599\u4EE5 Frame \u70BA\u6700\u5C0F\u55AE\u4F4D\u3001\u6642\u9593\u4EE5 timestamp \u8868\u793A\u3001\u5169\u8005\u914D\u5408\u64AD\u653E\u5668\u7684\u6642\u8108\u5EFA\u7ACB\u540C\u6B65\u3002"}),"\n",(0,t.jsx)(i.h2,{id:"\u8996\u8A0A\u5E40video-frame",children:"\u8996\u8A0A\u5E40(Video Frame)"}),"\n",(0,t.jsx)(i.p,{children:"\u5F71\u50CF\u5E40\u662F\u4E00\u500B\u975C\u614B\u756B\u9762\u3002\u7DE8\u78BC\u5668\u3001\u64AD\u653E\u5668\u3001\u5BB9\u5668\u683C\u5F0F\u90FD\u4EE5 Frame \u4F5C\u70BA\u8655\u7406\u55AE\u4F4D\u3002\u5BE6\u52D9\u4E0A\uFF0C\u4E00\u500B Frame \u5177\u6709\u4EE5\u4E0B\u8CC7\u8A0A\uFF1A"}),"\n",(0,t.jsx)(i.p,{children:"\u5F71\u50CF\u5E40\u5167\u5BB9\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"\u5C3A\u5BF8\u8207\u50CF\u7D20\u683C\u5F0F\uFF08\u4F8B\u5982 YUV420\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"\u64AD\u653E\u9806\u5E8F\u6642\u9593\uFF08PTS\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"\u89E3\u78BC\u9806\u5E8F\u6642\u9593\uFF08DTS\uFF0C\u6709\u4E9B\u683C\u5F0F\u624D\u9700\u8981\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"\u662F\u5426\u70BA\u95DC\u9375\u756B\u9762\uFF08I-frame\uFF09\u6216\u9810\u6E2C\u756B\u9762"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Frame \u672C\u8EAB\u4E0D\u5E36\u300C\u79D2\u6578\u300D\uFF0C\u53EA\u5E36 timestamp\u3002\u79D2\u6578\u662F\u7531\u300Ctimestamp \xf7 timebase\u300D\u63DB\u7B97\u51FA\u4F86\u3002"}),"\n",(0,t.jsx)(i.p,{children:"\u4F8B\uFF1A\u4E00\u500B H264 stream \u7684\u6642\u9593\u57FA\u5E38\u898B\u70BA 1 / 9K\u3002\u82E5\u67D0 Frame \u7684 Timestamp \u662F 18K\uFF0C\u4EE3\u8868\u5B83\u61C9\u5728\u300C18K / 9K = 2 \u79D2\u300D\u64AD\u653E\u3002"}),"\n",(0,t.jsx)(i.h2,{id:"\u97F3\u8A0A\u5E40audio-frame",children:"\u97F3\u8A0A\u5E40(Audio Frame)"}),"\n",(0,t.jsx)(i.p,{children:"\u97F3\u8A0A\u5E40\u662F\u4E00\u6BB5\u56FA\u5B9A\u9577\u5EA6\u7684\u53D6\u6A23\u8CC7\u6599\u3002\u8072\u97F3\u5728\u6642\u9593\u8EF8\u4E0A\u662F\u9023\u7E8C\u7684\u8A0A\u865F\uFF0C\u56E0\u6B64\u7DE8\u78BC\u524D\u6703\u5148\u88AB\u5207\u6210\u591A\u6BB5\uFF0C\u6BCF\u6BB5\u5F62\u6210\u4E00\u500B Audio Frame\u3002\u6BCF\u500B\u97F3\u8A0A\u7DE8\u78BC\u5668\u6703\u5B9A\u7FA9\u81EA\u5DF1\u7684 frame duration\uFF0C\u4F8B\u5982 AAC \u5E38\u898B 1024 samples\uFF0COpus \u5E38\u898B 20ms \u6216 60ms\u3002\u9019\u4E9B\u90FD\u6703\u53CD\u6620\u5728 timestamp \u7684\u9023\u7E8C\u6027\u4E0A\u3002"}),"\n",(0,t.jsx)(i.p,{children:"\u97F3\u8A0A\u5E40\u5167\u5BB9\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"\u4E00\u6BB5\u6A23\u672C\u5E8F\u5217\uFF08PCM \u6216\u7DE8\u78BC\u5F8C\u7684 bitstream\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"\u53D6\u6A23\u7387\u8207 channel layout"}),"\n",(0,t.jsx)(i.li,{children:"\u64AD\u653E\u6642\u9593\u6233\uFF08PTS\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"\u7DE8\u78BC\u5668\u5167\u90E8\u9700\u8981\u7684\u9644\u52A0\u8CC7\u8A0A\uFF0C\u4F8B\u5982 Opus \u7684 TOC byte"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"\u6642\u9593\u6233timestamp-\u8207-\u6642\u57FAtimebase",children:"\u6642\u9593\u6233(Timestamp) \u8207 \u6642\u57FA(Timebase)"}),"\n",(0,t.jsx)(i.p,{children:"Timestamp \u662F\u4E00\u500B\u905E\u589E\u7684\u6574\u6578\u3002\u5B83\u672C\u8EAB\u6C92\u6709\u610F\u7FA9\uFF0C\u9700\u8981 timebase \u624D\u80FD\u63DB\u7B97\u70BA\u79D2\u6578\u3002timebase \u901A\u5E38\u7531\u7DE8\u78BC\u5668\u3001\u5BB9\u5668\u6216 RTP profile \u5B9A\u7FA9\u3002\u4E0D\u540C\u968E\u6BB5\u53EF\u80FD\u4F7F\u7528\u4E0D\u540C\u7684 timebase\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"H264 NALU \u5728 Annex B \u968E\u6BB5\u6C92\u6709\u6642\u9593\u8CC7\u8A0A"}),"\n",(0,t.jsx)(i.li,{children:"\u5C01\u88DD\u5230 MP4 \u6642\u6703\u88AB\u8CE6\u4E88 timebase\uFF0C\u4F8B\u5982 1/90000"}),"\n",(0,t.jsx)(i.li,{children:"RTP \u50B3\u8F38\u540C\u6A23\u4F7F\u7528 90kHz \u4F5C\u70BA video timestamp \u7684\u57FA\u6E96"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u82E5\u5169\u500B\u7CFB\u7D71\u7684 timebase \u4E0D\u4E00\u81F4\uFF0C\u5C31\u9700\u8981\u5728\u91CD\u5C01\u88DD\u6642\u91CD\u65B0\u8A08\u7B97 timestamp\uFF0C\u4F7F\u64AD\u653E\u6642\u5E8F\u7DAD\u6301\u4E00\u81F4\u3002"}),"\n",(0,t.jsxs)(i.admonition,{type:"tip",children:[(0,t.jsxs)(i.p,{children:["\u6642\u523B (Timescale) \u8207\u6642\u57FA (Timebase) \u662F\u4E00\u500B\u7CBE\u78BA\u4E14\u7A69\u5B9A\u7684\u6642\u9593\u53C3\u8003\u3002\u5176\u542B\u610F\u662F\u5C071\u79D2\u5283\u5206\u70BA\u5E7E\u500B\u523B\u5EA6\uFF0C\u6BD4\u65B9\u8AAA Timescale = ",(0,t.jsx)(i.code,{children:"90000"}),"\uFF0C\u5247 Timebase = ",(0,t.jsx)(i.code,{children:"1 / 90000"}),"\uFF0C\u5982\u679C\u67D0\u500B\u5E40\u7684\u6642\u6233\u70BA 3600\uFF0C\u5247\u5FC5\u9808\u5728\u7B2C ",(0,t.jsx)(i.code,{children:"3600 * Timebase"})," \u79D2\u986F\u793A\u3002"]}),(0,t.jsxs)(i.p,{children:["\u6642\u57FA\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u5982\u679C\u76F4\u63A5\u4EE5\u63A1\u6A23\u7387 SR \u9032\u884C\u63DB\u7B97\uFF0C\u5E38\u898B\u7684 SR \u70BA 24 , 25 , 30\u3002\u53EA\u8981 ",(0,t.jsx)(i.code,{children:"1 / SR"})," \u7684\u7D50\u679C\u662F\u7121\u9650\u5C0F\u6578\u5FAA\u74B0\uFF0C\u4F7F\u7528 ",(0,t.jsx)(i.code,{children:"float"})," \u8207 ",(0,t.jsx)(i.code,{children:"double"})," \u90FD\u6703\u6709\u5FAE\u5C0F\u7684\u8AA4\u5DEE\uFF0C\u7576\u64AD\u653E\u7684\u5F71\u7247\u6642\u9593\u8DB3\u5920\u9577\uFF0C\u5C31\u6703\u5C0E\u81F4\u97F3\u8A0A\u8207\u8996\u8A0A\u7684\u6F02\u79FB(\u4E0D\u540C\u6B65)\u3002\u4EE5 90000 \u4F86\u8AAA\uFF0C\u4ED6\u662F\u5E38\u898B\u7684\u63A1\u6A23\u7387\u7684\u516C\u500D\u6578\uFF0C\u4F7F\u5F97\u97F3\u8996\u8A0A\u53EF\u4EE5\u5728\u6574\u6578\u57DF\u4E0A\u9032\u884C\u8A08\u7B97\uFF0C\u907F\u514D\u5931\u771F\u3002"]})]}),"\n",(0,t.jsx)(i.h2,{id:"pts-\u8207-dts",children:"PTS \u8207 DTS"}),"\n",(0,t.jsx)(i.p,{children:"PTS \u8868\u793A\u64AD\u653E\u9806\u5E8F\u3002DTS \u8868\u793A\u89E3\u78BC\u9806\u5E8F\u3002\u5B58\u5728 B-frame(\u96D9\u5411\u9810\u6E2C\u5E40) \u7684\u7DE8\u78BC\u5668\u6703\u9047\u5230\u300C\u89E3\u78BC\u9806\u5E8F\u8207\u64AD\u653E\u9806\u5E8F\u4E0D\u4E00\u81F4\u300D\u7684\u60C5\u6CC1\uFF0C\u56E0\u6B64 DTS \u6703\u843D\u5F8C\u65BC PTS\u3002\u6C92\u6709 B-frame \u7684\u4F4E\u5EF6\u9072\u8A2D\u5B9A\u4E0D\u9700\u8981 DTS\uFF0C\u64AD\u653E\u5668\u53EF\u76F4\u63A5\u4F9D PTS \u9032\u884C\u6392\u7A0B\u3002\u9019\u662F\u56E0\u70BA B-Frame \u540C\u6642\u53C3\u8003\u4E86\u524D\u4E00\u5E40\u8207\u5F8C\u4E00\u5E40\u7684\u8CC7\u8A0A\uFF0C\u56E0\u6B64\u89E3\u78BC\u9806\u5E8F\u8207\u64AD\u653E\u9806\u5E8F\u53EF\u80FD\u6703\u4E0D\u4E00\u6A23\u3002"}),"\n",(0,t.jsx)(i.p,{children:"\u4F8B\uFF1A\u5728\u4E00\u6BB5\u542B B-frame \u7684\u6D41\u4E2D\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Frame 1\uFF1AI-frame"}),"\n",(0,t.jsx)(i.li,{children:"Frame 2\uFF1AB-frame"}),"\n",(0,t.jsx)(i.li,{children:"Frame 3\uFF1AP-frame"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u89E3\u78BC\u9806\u5E8F\u662F 1 \u2192 3 \u2192 2\uFF0C\u64AD\u653E\u9806\u5E8F\u662F 1 \u2192 2 \u2192 3\u3002PTS/DTS \u7528\u4F86\u89E3\u6C7A\u9019\u500B\u5DEE\u7570\uFF0C\u907F\u514D\u64AD\u653E\u5668\u932F\u8AA4\u6392\u5E8F\u5C0E\u81F4\u756B\u9762\u505C\u9813\u3002"}),"\n",(0,t.jsx)(i.h2,{id:"frame-\u8207-container-\u7684\u95DC\u4FC2",children:"Frame \u8207 Container \u7684\u95DC\u4FC2"}),"\n",(0,t.jsx)(i.p,{children:"Frame \u5728\u5BB9\u5668\u683C\u5F0F\u4E2D\u88AB\u653E\u9032\u5C0D\u61C9\u7684\u5C01\u5305\u3002\u4F8B\u5982\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"\u5728 TS \u4E2D\u662F PES packet\u3002"}),"\n",(0,t.jsx)(i.li,{children:"\u5728 MP4 \u4E2D\u6703\u5F62\u6210 sample \u4E26\u88AB\u7D22\u5F15\u5230\u5C0D\u61C9\u7684 track\u3002"}),"\n",(0,t.jsx)(i.li,{children:"\u5728 WebM/Matroska \u4E2D\u5247\u662F Block \u5167\u7684\u55AE\u4E00 frame\u3002"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u5BB9\u5668\u4E0D\u6703\u6539\u8B8A frame \u7684\u5167\u5BB9\uFF0C\u4F46\u6703\u91CD\u65B0\u8CE6\u4E88\u6642\u9593\u8CC7\u8A0A\uFF0C\u4F8B\u5982\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"sample duration"}),"\n",(0,t.jsx)(i.li,{children:"composition time offset\uFF08\u89E3\u6C7A B-frame \u91CD\u6392\uFF09"}),"\n",(0,t.jsx)(i.li,{children:"decode time"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u91CD\u5C01\u88DD\u6642\uFF0Ctimestamp \u8655\u7406\u662F\u5FC5\u8981\u5DE5\u4F5C\u3002\u4F8B\u5982\u628A Annex B H264 \u5C01\u88DD\u9032 fMP4\uFF0C\u9700\u8981\u91CD\u5EFA sample duration \u8207 composition time offset\uFF0C\u5426\u5247\u64AD\u653E\u5668\u7121\u6CD5\u6B63\u78BA\u64AD\u653E\u3002"}),"\n",(0,t.jsx)(i.p,{children:"RTP \u4E0D\u76F4\u63A5\u50B3 Frame\uFF0C\u800C\u662F\u5C07 Frame \u62C6\u6210\u591A\u500B RTP packets\u3002\u6BCF\u500B packet \u5E36\u76F8\u540C timestamp\uFF0C\u4EE3\u8868\u5B83\u5011\u5C6C\u65BC\u540C\u4E00\u500B Frame\u3002marker bit \u901A\u5E38\u5728\u6700\u5F8C\u4E00\u500B packet \u8A2D\u5B9A\uFF0C\u7528\u4F86\u6307\u793A frame boundary\u3002"}),"\n",(0,t.jsx)(i.p,{children:"RTP timestamp \u4E0D\u7B49\u65BC\u7DE8\u78BC\u5668\u539F\u59CB timestamp\u3002\u5B83\u662F\u4EE5 RFC \u898F\u7BC4\u7684 clock rate \u905E\u589E\uFF1A"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Video\uFF1A90kHz"}),"\n",(0,t.jsx)(i.li,{children:"Audio\uFF08Opus\uFF09\uFF1A48kHz"}),"\n",(0,t.jsx)(i.li,{children:"Audio\uFF08AAC\uFF09\uFF1A\u53D6\u6A23\u7387"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"\u82E5\u5728\u8F49\u5C01\u88DD\u5230 RTP \u6642\uFF0C\u6C92\u6709\u6B63\u78BA\u63DB\u7B97 timestamp\uFF0C\u63A5\u6536\u7AEF\u6703\u906D\u9047 jitter\u3001\u64AD\u653E\u5EF6\u9072\u7D2F\u7A4D\u6216\u540C\u6B65\u932F\u4F4D\u3002"}),"\n",(0,t.jsx)(i.h2,{id:"\u53EF\u80FD\u767C\u751F\u7684\u932F\u8AA4",children:"\u53EF\u80FD\u767C\u751F\u7684\u932F\u8AA4"}),"\n",(0,t.jsx)(i.h3,{id:"audiovideo-\u4E0D\u540C\u6B65",children:"Audio/Video \u4E0D\u540C\u6B65"}),"\n",(0,t.jsx)(i.p,{children:"\u5F71\u50CF timestamp \u4F7F\u7528 timebase A\uFF0C\u97F3\u8A0A\u4F7F\u7528 timebase B\uFF0C\u4F46\u5169\u8005\u6C92\u6709\u63DB\u7B97\u6210\u5171\u540C timebase \u3002\u64AD\u653E\u5668\u7121\u6CD5\u5C0D\u9F4A\uFF0C\u6703\u8868\u73FE\u6210\u300C\u97F3\u63D0\u65E9\u300D\u6216\u300C\u756B\u9762\u843D\u5F8C\u300D\u3002"}),"\n",(0,t.jsx)(i.h3,{id:"b-frame-\u8A2D\u5B9A\u932F\u8AA4",children:"B-frame \u8A2D\u5B9A\u932F\u8AA4"}),"\n",(0,t.jsx)(i.p,{children:"\u82E5\u5C01\u88DD\u6642\u932F\u7F6E composition time offset\uFF0CB-frame \u6D41\u6703\u76F4\u63A5\u7834\u640D\uFF0C\u4F8B\u5982\u756B\u9762\u6296\u52D5\u3001\u64AD\u653E\u9806\u5E8F\u932F\u4E82\u3002"})]})}function o(e={}){let{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},5511:function(e,i,n){n.d(i,{R:()=>l,x:()=>a});var s=n(6363);let t={},r=s.createContext(t);function l(e){let i=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:i},e.children)}},8894:function(e){e.exports=JSON.parse('{"permalink":"/blog/20251208T000000002","source":"@site/blog/20251208T000000002.md","title":"\u5E40(Frame) \u8207 \u6642\u9593\u6233(Timestamp)","description":"\u5E40\u7684\u57FA\u672C\u7D50\u69CB\u8207\u5B83\u5728\u50B3\u8F38\u6D41\u7A0B\u4E2D\u7684\u5B9A\u4F4D\u3002","date":"2025-12-08T00:00:00.000Z","tags":[{"inline":false,"label":"\u4E32\u6D41\u61C9\u7528\u958B\u767C","permalink":"/blog/tags/streaming","description":"\u4E32\u6D41\u61C9\u7528\u958B\u767C\uFF1A\u7DE8\u89E3\u78BC\u5668\u3001\u97F3\u8996\u983B\u591A\u5A92\u9AD4\u6846\u67B6\u3001\u4E32\u6D41\u958B\u767C\u3002"}],"readingTime":4.05,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"\u5E40(Frame) \u8207 \u6642\u9593\u6233(Timestamp)","description":"\u5E40\u7684\u57FA\u672C\u7D50\u69CB\u8207\u5B83\u5728\u50B3\u8F38\u6D41\u7A0B\u4E2D\u7684\u5B9A\u4F4D\u3002","authros":"yhchen","tags":["streaming"],"date":"2025-12-08T00:00:00.000Z"},"unlisted":false,"lastUpdatedAt":1765384201000,"lastUpdatedBy":"yhchen","prevItem":{"title":"\u97F3\u8996\u983B\u57FA\u672C\u8655\u7406\u6D41\u7A0B","permalink":"/blog/20251208T000000001"},"nextItem":{"title":"\u6211\u60F3\u5BEB\u4EC0\u9EBC","permalink":"/blog/20251116T000000000"}}')}}]);